<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Toji Masaya – drone/camera/travel</title>

  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <!-- SEO -->
  <meta name="description" content="田路昌也(TJ)のポートフォリオサイト。ライカやドローンを片手に、旅先の空気や日々の発見を写真と文章で記録しています。">
  <meta name="keywords" content="田路昌也, TJ, 旅行, 写真, ライター, 香港, カッパドキア, note">
  <meta name="author" content="Toji Masaya">

  <!-- OGP -->
  <meta property="og:title" content="TJM – drone/camera/travel">
  <meta property="og:description" content="香港と日本を行き来しながら、旅先で出会った風景や小さな発見を写真と言葉で綴っています。トップにあるのは、生まれ故郷・姫路の近くにある砥峰高原。秋の気配をまとったススキの風が、ページの奥へと誘ってくれます。">
  <meta property="og:image" content="https://tojimasaya.com/assets/images/gallery/tonomine-susuki.jpg">
  <meta property="og:url" content="https://tojimasaya.com">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="TJM">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TJM – drone/camera/travel">
  <meta name="twitter:description" content="香港と日本を行き来しながら、旅先で出会った風景や小さな発見を綴っています。トップは砥峰高原のススキ原。">
  <meta name="twitter:image" content="https://tojimasaya.com/assets/images/gallery/tonomine-susuki.jpg">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css?v=20251018">

  <!-- Theme -->
  <meta name="theme-color" content="#fafafa">
  <meta name="theme-color" content="#1a1a1a" media="(prefers-color-scheme: dark)">
</head>

<body>
  <!-- Skip Link -->
  <a href="#main-content" class="skip-link">メインコンテンツにスキップ</a>

  <!-- Navigation -->
  <nav class="main-nav" id="main-nav">
    <div class="nav-container">
      <a href="/" class="nav-logo">TJM</a>
      <ul class="nav-menu" id="nav-menu">
        <li><a href="/" class="nav-link active">Home</a></li>
        <li><a href="/gallery.html" class="nav-link">Gallery</a></li>
        <li><a href="/gear.html" class="nav-link">Gear</a></li>
        <li><a href="/writings.html" class="nav-link">Writings</a></li>
      </ul>
      <button class="nav-toggle" id="nav-toggle" aria-label="メニューを開く">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Hero Section with Ken Burns Effect -->
  <section class="hero" role="banner">
    <div class="hero-slides-container">
      <!-- Slide 1: 砥峰高原 -->
      <div class="hero-slide active">
        <img src="assets/images/gallery/tonomine-susuki.jpg"
             alt="砥峰高原のススキ原"
             loading="eager"
             fetchpriority="high"
             width="1920" height="1080">
      </div>

      <!-- Slide 2: カッパドキア -->
      <div class="hero-slide">
        <img src="assets/images/gallery/cappadocia.jpg"
             alt="カッパドキアの風景"
             loading="lazy"
             width="1920" height="1080">
      </div>

      <!-- Slide 3: 香港 -->
      <div class="hero-slide">
        <img src="assets/images/gallery/hongkong.jpg"
             alt="香港の街並み"
             loading="lazy"
             width="1920" height="1080">
      </div>

      <!-- Slide 4: イスタンブール -->
      <div class="hero-slide">
        <img src="assets/images/gallery/istanbul.jpg"
             alt="イスタンブールの風景"
             loading="lazy"
             width="1920" height="1080">
      </div>
    </div>

    <!-- Text Overlay -->
    <div class="hero-overlay">
      <h1 class="hero-title">TJM</h1>
      <p class="hero-subtitle">drone/camera/travel</p>
    </div>

    <!-- Navigation Dots -->
    <div class="hero-dots">
      <div class="dot active" data-slide="0"></div>
      <div class="dot" data-slide="1"></div>
      <div class="dot" data-slide="2"></div>
      <div class="dot" data-slide="3"></div>
    </div>
  </section>

  <!-- Main Content -->
  <main id="main-content" class="main-content">
    <div class="container">

      <!-- Introduction -->
      <section class="intro">
        <div class="intro-text">
          <p>最近、香港と日本の二拠点生活をしています。</p>
          <p>生まれ故郷・姫路からほど近い砥峰高原。</p>
          <p>ここは、「軍師官兵衛」や「ノルウェイの森」などのロケ地として知られています。</p>

          <p class="spacer"></p>

          <p>10月初旬の訪問はススキの最盛期には少し早かったけれど、</p>
          <p>風は冷たく、空の色にはもう秋の気配。</p>
          <p>ついこの前まで香港で感じていた夏の熱気が、</p>
          <p>遠い季節の記憶のように思えました。</p>

          <p class="spacer"></p>

          <p>人は季節を通して、</p>
          <p>時間の速さを知るのかもしれません。</p>
        </div>
      </section>

      <!-- Latest from TJM -->
      <section class="latest-section" aria-labelledby="latest-heading">
        <h2 id="latest-heading" class="latest-title">
          <span class="en-title">What's New</span>
          <span class="jp-subtitle">最新記事</span>
        </h2>
        <div class="latest-grid">

          <!-- DRONE.jp（自動更新） -->
          <article class="content-card" id="latest-drone-card">
            <div class="content-image">
              <a id="latest-drone-url" href="#" target="_blank" rel="noopener noreferrer">
                <img id="latest-drone-thumb" src="assets/images/gear/dronejplatest.jpg" alt="DRONE.jp 連載のサムネイル" loading="lazy">
              </a>
            </div>
            <div class="content-info">
              <span class="content-category">DRONE.jp 連載</span>
              <h3>
                <a id="latest-drone-title" href="#" target="_blank" rel="noopener noreferrer">
                  読み込み中...
                </a>
              </h3>
              <p class="preview-excerpt" id="latest-drone-caption">最新記事を取得中...</p>
              <a class="card-action-btn" id="latest-drone-cta" href="#" target="_blank" rel="noopener noreferrer">Read on DRONE.jp →</a>
            </div>
          </article>

          <!-- note（自動更新） -->
          <article class="content-card" id="latest-oreryu-card" aria-live="polite">
            <div class="content-image">
              <a id="latest-note-url" href="#" target="_blank" rel="noopener noreferrer">
                <img id="latest-note-thumb" src="assets/images/gear/oreryulatest.jpg" alt="note 最新記事のサムネイル" loading="lazy">
              </a>
            </div>
            <div class="content-info">
              <span class="content-category">note 最新記事</span>
              <h3 id="latest-oreryu-title">
                <a href="#" target="_blank" rel="noopener noreferrer">
                  読み込み中...
                </a>
              </h3>
              <p id="latest-oreryu-meta" class="preview-excerpt">最新記事を取得中...</p>
              <a id="latest-oreryu-link" class="card-action-btn" href="#" target="_blank" rel="noopener noreferrer">Read on note →</a>
            </div>
          </article>

          <!-- Gallery（手動） -->
          <article class="content-card" id="latest-gallery-card">
            <div class="content-image">
              <a id="latest-gallery-url" href="/gallery.html">
                <img id="latest-gallery-thumb" src="assets/images/gallery/tonomine-susuki.jpg" alt="最新ギャラリーのサムネイル" loading="lazy">
              </a>
            </div>
            <div class="content-info">
              <span class="content-category">Gallery</span>
              <h3><a id="latest-gallery-title" href="/gallery.html">砥峰高原のススキ原</a></h3>
              <p class="preview-excerpt" id="latest-gallery-caption">秋の気配を連れてくる風。旅の最新スナップはGalleryへ。</p>
              <a class="card-action-btn" href="/gallery.html">View Gallery →</a>
            </div>
          </article>

        </div>
      </section>

      <!-- About -->
      <section class="about-section" aria-labelledby="about-heading">
        <h2 id="about-heading">About</h2>
        <div class="about-content">
          <p>
            香港と日本を行き来しながら、ライカとドローンで旅の記憶を記録しています。
            写真と言葉、そして少しのガジェット偏愛。ここはその交差点です。
          </p>
          <div class="about-links">
            <a href="https://note.com/tojimasaya" target="_blank" rel="noopener noreferrer" class="external-link">note</a>
            <a href="https://drone.jp/column/masaya-toji" target="_blank" rel="noopener noreferrer" class="external-link">DRONE.jp</a>
            <a href="https://twitter.com/mongkok93" target="_blank" rel="noopener noreferrer" class="external-link">X (Twitter)</a>
            <a href="mailto:tojimasaya07@gmail.com" class="external-link">Contact</a>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="footer" role="contentinfo">
        <div class="footer-content">
          <p>&copy; 2025 Toji Masaya. All rights reserved.</p>
          <p>Built with care in Japan</p>
        </div>
      </footer>

    </div>
  </main>

  <!-- Scripts -->
  <script>
    // ===== Hero Ken Burns slideshow =====
    const slides = document.querySelectorAll('.hero-slide');
    const dots   = document.querySelectorAll('.dot');
    let currentSlide = 0;
    const slideInterval = 8000;

    function showSlide(i){
      slides.forEach(s=>s.classList.remove('active'));
      dots.forEach(d=>d.classList.remove('active'));
      slides[i].classList.add('active');
      dots[i].classList.add('active');
    }
    function nextSlide(){ currentSlide = (currentSlide+1)%slides.length; showSlide(currentSlide); }

    let autoSlide = setInterval(nextSlide, slideInterval);
    dots.forEach(dot=>{
      dot.addEventListener('click', ()=>{
        clearInterval(autoSlide);
        currentSlide = parseInt(dot.getAttribute('data-slide'));
        showSlide(currentSlide);
        autoSlide = setInterval(nextSlide, slideInterval);
      });
    });
    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden){ clearInterval(autoSlide); }
      else{ autoSlide = setInterval(nextSlide, slideInterval); }
    });

    // ===== Navigation =====
    const navToggle = document.getElementById('nav-toggle');
    const navMenu   = document.getElementById('nav-menu');
    if (navToggle && navMenu) {
      navToggle.addEventListener('click', ()=>{
        navMenu.classList.toggle('active');
        navToggle.classList.toggle('active');
        document.body.classList.toggle('nav-open');
      });
      document.querySelectorAll('.nav-link').forEach(link=>{
        link.addEventListener('click', ()=>{
          if (window.innerWidth <= 768) {
            navMenu.classList.remove('active');
            navToggle.classList.remove('active');
            document.body.classList.remove('nav-open');
          }
        });
      });
    }
    window.addEventListener('scroll', ()=>{
      const nav = document.getElementById('main-nav');
      if (window.scrollY > 50) nav.classList.add('scrolled'); else nav.classList.remove('scrolled');
    });

    // ========================================
    // writings-og.json から最新記事を自動取得
    // ========================================

    // デフォルト画像（フォールバック用）
    const DEFAULT_IMAGES = {
        drone: 'assets/images/gear/dronejplatest.jpg',
        note: 'assets/images/gear/oreryulatest.jpg'
    };

    // 日付抽出ヘルパー
    function extractDateFromURL(url) {
        // DRONE.jp形式: /20250912114426119738.html
        const droneMatch = url.match(/\/(\d{14})\d+\.html/);
        if (droneMatch) return droneMatch[1];
        
        // note形式: /n/nXXXXXXXXXXXX
        const noteMatch = url.match(/\/n\/n([a-f0-9]+)/);
        if (noteMatch) return noteMatch[1];
        
        return '0';
    }

    // 日付フォーマット（YYYYMMDD... → YYYY年M月D日）
    function formatDate(urlOrDateStr) {
        const dateStr = extractDateFromURL(urlOrDateStr);
        if (dateStr === '0' || dateStr.length < 8) return '最新';
        
        const year = dateStr.substring(0, 4);
        const month = parseInt(dateStr.substring(4, 6), 10);
        const day = parseInt(dateStr.substring(6, 8), 10);
        
        return `${year}年${month}月${day}日`;
    }

    // 俺流トラベルガジェットのマガジンURLリスト
    const ORERYU_MAGAZINE_URLS = [
        'https://note.com/tojimasaya/m/mcae365b520ed'
    ];

    // writings-og.json から最新記事を取得
    async function loadLatestArticles() {
        try {
            const response = await fetch('/data/writings-og.json');
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            
            const articlesData = await response.json();
            
            // 1. DRONE.jp 最新記事
            const droneArticles = Object.entries(articlesData)
                .filter(([url]) => url.includes('drone.jp/column'))
                .sort((a, b) => {
                    const dateA = extractDateFromURL(a[0]);
                    const dateB = extractDateFromURL(b[0]);
                    return dateB.localeCompare(dateA);
                });
            
            // 2. 俺流トラベルガジェット 最新記事
            // RSSから記事情報を取得（URL、タイトル、日付）
            let oreryuArticle = null;
            try {
                const rssResponse = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(ORERYU_MAGAZINE_URLS[0] + '/rss')}`);
                if (rssResponse.ok) {
                    const xmlText = await rssResponse.text();
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
                    const firstItem = xmlDoc.querySelector('item');
                    
                    if (firstItem) {
                        const url = firstItem.querySelector('link')?.textContent.trim();
                        const title = firstItem.querySelector('title')?.textContent.trim();
                        const pubDate = firstItem.querySelector('pubDate')?.textContent.trim();
                        
                        // writings-og.jsonから画像情報を取得
                        const ogData = url ? articlesData[url] : null;
                        const image = ogData?.image || DEFAULT_IMAGES.note;
                        
                        if (url) {
                            oreryuArticle = [url, {
                                title: title || ogData?.title || '',
                                image: image,
                                pubDate: pubDate // RSSの日付を保持
                            }];
                        }
                    }
                }
            } catch (e) {
                console.warn('俺流RSS取得エラー:', e);
            }
            
            return {
                drone: droneArticles[0] || null,
                note: oreryuArticle
            };
            
        } catch (error) {
            console.error('writings-og.json 読み込みエラー:', error);
            return { drone: null, note: null };
        }
    }

    // Home の "What's New" セクションを更新
    async function updateHomeLatest() {
        const latest = await loadLatestArticles();
        
        // DRONE.jp カード更新
        if (latest.drone) {
            const [url, data] = latest.drone;
            const thumbnail = data.image || DEFAULT_IMAGES.drone;
            const title = data.title || 'DRONE.jp 連載最新記事';
            
            document.getElementById('latest-drone-url').href = url;
            document.getElementById('latest-drone-title').textContent = title;
            document.getElementById('latest-drone-title').href = url;
            document.getElementById('latest-drone-thumb').src = thumbnail;
            document.getElementById('latest-drone-thumb').alt = title;
            document.getElementById('latest-drone-caption').textContent = `DRONE.jp - ${formatDate(url)}`;
            document.getElementById('latest-drone-cta').href = url;
            
            console.log('✓ DRONE.jp 最新記事を更新:', title);
        }
        
        // note カード更新
        if (latest.note) {
            const [url, data] = latest.note;
            const thumbnail = data.image || DEFAULT_IMAGES.note;
            const title = data.title || 'note 最新記事';
            
            document.getElementById('latest-note-url').href = url;
            document.getElementById('latest-note-thumb').src = thumbnail;
            document.getElementById('latest-note-thumb').alt = title;
            
            const titleEl = document.querySelector('#latest-oreryu-title a');
            if (titleEl) {
                titleEl.textContent = title;
                titleEl.href = url;
            }
            
            const metaEl = document.getElementById('latest-oreryu-meta');
            if (metaEl) {
                metaEl.textContent = `note - ${formatDate(url)}`;
            }
            
            document.getElementById('latest-oreryu-link').href = url;
            
            console.log('✓ note 最新記事を更新:', title);
        }
    }

    // ページ読み込み時に実行
    document.addEventListener('DOMContentLoaded', () => {
        updateHomeLatest();
    });

    // External links security
    document.querySelectorAll('a[target="_blank"]').forEach(link => { link.rel = 'noopener noreferrer'; });
  </script>

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "田路昌也",
    "alternateName": "Toji Masaya",
    "jobTitle": "Writer and Travel Photographer",
    "url": "https://tojimasaya.com",
    "sameAs": [
      "https://note.com/tojimasaya",
      "https://x.com/mongkok93"
    ],
    "description": "ライカやドローンを片手に、気の向くままに旅をしています。写真と文章で、旅先の空気や日々の発見をゆる〜く記録しています。"
  }
  </script>
</body>
</html>